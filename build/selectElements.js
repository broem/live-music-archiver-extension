if(!0!==window.contentScriptInjected){window.contentScriptInjected=!0;var stopAll=!0,freezeState=!0,runSelect=!0,activeSelected=[],prevSelected=[],filtManualSelected=[],borderedInnerHTML=[],prevNode=null,stopMouseover=!0,body=document.getElementsByTagName("body")[0],bodyWidth=body.clientWidth,bodyHeight=body.clientHeight,rectArea=0;function addBorderPrimary(e){"IMG"==e.nodeName?(e.classList.add("activeBorderImage"),e.classList.add("activeBorderPrimary")):"A"==e.nodeName?(e.style.position="relative",e.classList.add("activeBorderPrimary")):e.classList.add("activeBorderPrimary")}function addBorderEvent(e){var t=e.getBoundingClientRect();t.width*t.height>=rectArea&&(rectArea=t.width*t.height,"IMG"==e.nodeName?(e.classList.add("activeBorderImage"),e.classList.add("activeBorderEvent"),null!=prevNode&&removeBorderEvent(prevNode)):"A"==e.nodeName?(e.style.position="relative",e.classList.add("activeBorderEvent"),null!=prevNode&&removeBorderEvent(prevNode)):(e.classList.add("activeBorderEvent"),null!=prevNode&&removeBorderEvent(prevNode)),prevNode=e)}function removeBorderPrimary(e){"IMG"==e.nodeName&&(e.classList.remove("activeBorderImage"),e.classList.remove("activeBorderPrimary"))}function removeBorderEvent(e){"IMG"==e.nodeName?(e.classList.remove("activeBorderImage"),e.classList.remove("activeBorderEvent")):e.classList.remove("activeBorderEvent")}function removePrimaryBorderAll(){document.querySelectorAll(".activeBorderPrimary").forEach((e=>{e.classList.remove("activeBorderPrimary"),e.classList.remove("activeBorderImage"),"absolute"==e.style.position&&(e.style.position="")}))}function removeEventBorderAll(){document.querySelectorAll(".activeBorderEvent").forEach((e=>{e.classList.remove("activeBorderEvent"),e.classList.remove("activeBorderImage")}))}function removeBorderAll(){document.querySelectorAll(".activeBorderPrimary, .activeBorderEvent, .previousBorderPrimary").forEach((e=>{e.classList.remove("activeBorderPrimary"),e.classList.remove("activeBorderImage"),e.classList.remove("activeBorderEvent"),e.classList.remove("previousBorderPrimary")}))}function selectingElements(){document.querySelectorAll("div, span, li, button, input, textarea, p, img, h1, h2, h3, h4, h5, a, ol, article, iframe, html").forEach((e=>{e.addEventListener("mouseenter",(function(){freezeState||!stopMouseover||stopAll||(removePrimaryBorderAll(),e.classList.contains("activeBorderEvent")||addBorderPrimary(e))})),e.addEventListener("mouseleave",(function(){freezeState||!stopMouseover||stopAll||removeBorderPrimary(e)})),e.addEventListener("click",doClick),e.addEventListener("dblclick",(function(e){stopAll||(e.preventDefault(),e.stopPropagation(),console.log("bringing it back 2"),chrome.runtime.sendMessage({msg:"Bring back scrape builder"}))}))}))}var doClick=e=>doathing(e);function doathing(e){stopAll||(e.preventDefault(),e.stopPropagation(),collectBordered(),chrome.runtime.sendMessage({msg:"Bring back scrape builder"}),stopAll=!0,freezeState=!0)}function addBorderClick(e){console.log(e),stopAll||(e.preventDefault(),e.stopPropagation(),collectBordered(),chrome.runtime.sendMessage({msg:"Bring back scrape builder"}),stopAll=!0,freezeState=!0,e.srcElement.removeEventListener("click",addBorderClick))}function removeBordered(e){document.querySelector(".previousBorderPrimary."+e).classList.remove("previousBorderPrimary",e)}function collectBordered(){console.log(activeSelected),activeSelected.length=0,console.log("grabbing borderedItems");var e=document.querySelectorAll(".activeBorderPrimary");console.log("gottem"),e.forEach((e=>{activeSelected.push(e)})),console.log("pushed nodes"),activeSelected.length>0&&(activeSelected[activeSelected.length-1].classList.contains("activeBorderPrimary")&&(activeSelected[activeSelected.length-1].classList.remove("activeBorderPrimary")??activeSelected[0].classList.remove("activeBorderPrimary")),activeSelected[activeSelected.length-1].classList.contains("activeBorderEvent")&&(activeSelected[activeSelected.length-1].classList.remove("activeBorderEvent")??activeSelected[0].classList.remove("activeBorderEvent")),activeSelected[activeSelected.length-1].classList.contains("previousBorderPrimary")&&(activeSelected[activeSelected.length-1].classList.remove("previousBorderPrimary")??activeSelected[0].classList.remove("previousBorderPrimary")),activeSelected[activeSelected.length-1].classList.contains("activeBorderImage")&&(activeSelected[activeSelected.length-1].classList.remove("activeBorderImage")??activeSelected[0].classList.remove("activeBorderImage")),prevSelected.push(activeSelected[activeSelected.length-1])??prevSelected.push(activeSelected[0]),console.log("send to bring back mboy"),chrome.runtime.sendMessage({scrapeThis:"Add to scrape builder",data:{textC:activeSelected[activeSelected.length-1].textContent??activeSelected[0].textContent,innerH:activeSelected[activeSelected.length-1].innerHTML??activeSelected[0].innerHTML,innerT:activeSelected[activeSelected.length-1].innerText??activeSelected[0].innerText,cName:activeSelected[activeSelected.length-1].className??activeSelected[0].className,tagName:activeSelected[activeSelected.length-1].tagName??activeSelected[0].tagName,url:window.location.href,src:activeSelected[0].src,value:myField,label:myLabel}}),console.log("mboy sent the mssg"),activeSelected[activeSelected.length-1].classList.add("previousBorderPrimary",myField)??activeSelected[0].classList.add("previousBorderPrimary",myField))}function collectBorderedEvent(){activeSelected.length=0;var e=document.querySelectorAll(".activeBorderEvent");e.forEach((e=>{removeBorderEvent(e),activeSelected.push(e)})),setTimeout((()=>{e.forEach((e=>{"IMG"==e.nodeName?(e.classList.add("activeBorderImage"),e.classList.add("activeBorderEvent")):e.classList.add("activeBorderEvent")}))}),400),borderedInnerHTML=Array.from(activeSelected).map((e=>e.innerHTML)),activeSelected.length>0&&(activeSelected[activeSelected.length-1].classList.contains("activeBorderPrimary")&&(activeSelected[activeSelected.length-1].classList.remove("activeBorderPrimary")??activeSelected[0].classList.remove("activeBorderPrimary")),activeSelected[activeSelected.length-1].classList.contains("activeBorderEvent")&&(activeSelected[activeSelected.length-1].classList.remove("activeBorderEvent")??activeSelected[0].classList.remove("activeBorderEvent")),activeSelected[activeSelected.length-1].classList.contains("previousBorderPrimary")&&(activeSelected[activeSelected.length-1].classList.remove("previousBorderPrimary")??activeSelected[0].classList.remove("previousBorderPrimary")),prevSelected.push(activeSelected[activeSelected.length-1])??prevSelected.push(activeSelected[0]),chrome.runtime.sendMessage({scrapeThis:"Add to scrape builder",data:{textC:activeSelected[activeSelected.length-1].textContent??activeSelected[0].textContent,innerH:activeSelected[activeSelected.length-1].innerHTML??activeSelected[0].innerHTML,innerT:activeSelected[activeSelected.length-1].innerText??activeSelected[0].innerText,cName:activeSelected[activeSelected.length-1].className??activeSelected[0].className,tagName:activeSelected[activeSelected.length-1].tagName??activeSelected[0].tagName,url:window.location.href,src:activeSelected[0].src,value:myField,label:myLabel}}),activeSelected[activeSelected.length-1].classList.add("previousBorderPrimary")??activeSelected[0].classList.add("previousBorderPrimary"))}function borderInRectCheck(e,t,r){if(null==e)return!1;var c=window.scrollY||window.scrollTop||document.getElementsByTagName("html")[0].scrollTop;const o=e.getBoundingClientRect();return t.x<=r.x&&t.y<=r.y?o.top>=t.y-c&&o.left>=t.x&&o.bottom<=r.y-c&&o.right<=r.x:t.x>r.x&&t.y<=r.y?o.top>=t.y-c&&o.left>=r.x&&o.bottom<=r.y-c&&o.right<=t.x:t.x<=r.x&&t.y>r.y?o.top>=r.y-c&&o.left>=t.x&&o.bottom<=t.y-c&&o.right<=r.x:t.x>r.x&&t.y>r.y?o.top>=r.y-c&&o.left>=r.x&&o.bottom<=t.y-c&&o.right<=t.x:void 0}function getMousePos(e,t){var r=e.getBoundingClientRect();return{x:t.clientX-r.left,y:t.clientY-r.top}}function canvasProcess(){var e=document.createElement("DIV");e.innerHTML=`<canvas id="canvas" width="${bodyWidth}" height="${bodyHeight}" style="z-index: 2147483647; pointer-events: none; position: absolute; top: 0; left: 0"></canvas>`,document.body.appendChild(e),canvasOperations()}function canvasOperations(){var e=document.getElementById("canvas"),t=e.getContext("2d"),r=null,c=null;document.addEventListener("mousedown",(function(t){stopAll||(stopMouseover=!1,freezeState||(r=null,c=null,r=getMousePos(e,t),t.preventDefault(),t.stopPropagation()))})),document.addEventListener("mousemove",(function(o){!r||0!=stopMouseover||freezeState||stopAll||(c=getMousePos(e,o),t.clearRect(0,0,e.width,e.height),t.fillStyle="rgba(76, 144, 255, 0.3)",t.shadowColor="rgba(76, 144, 255)",t.shadowBlur=4,t.lineJoin="bevel",t.lineWidth=3,t.strokeStyle="rgb(123, 168, 252)",t.strokeRect(r.x,r.y,c.x-r.x,c.y-r.y),t.fillRect(r.x,r.y,c.x-r.x,c.y-r.y))})),document.addEventListener("mouseup",(function(o){if(!stopAll){if(!freezeState&&r&&c)t.clearRect(0,0,e.width,e.height),c=getMousePos(e,o),t.fillStyle="rgba(76, 144, 255, 0.3)",t.shadowColor="rgba(76, 144, 255)",t.shadowBlur=6,t.lineJoin="bevel",t.lineWidth=4,t.strokeStyle="rgb(123, 168, 252)",t.strokeRect(r.x,r.y,c.x-r.x,c.y-r.y),t.fillRect(r.x,r.y,c.x-r.x,c.y-r.y),console.log("COLLECTING..."),document.querySelectorAll("span, th, td, button, input, a, textarea, p, li, ol, card, img, section, nav, footer, header, map, video, audio, embed, iframe, object, picture, portal, param, source, form, fieldset, datalist, label, legend, select, option, output, progress, meter, h1, h2, h3, h4, h5, h6, pre").forEach((e=>{"absolute"===e.style.position&&(console.log("absolute"),e.style.position="relative"),borderInRectCheck(e,r,c)&&addBorderEvent(e)})),collectBorderedEvent(),rectArea=0,freezeState=!0,removeEventBorderAll(),t.clearRect(0,0,e.width,e.height),chrome.runtime.sendMessage({msg:"Bring back scrape builder"});t.clearRect(0,0,e.width,e.height),stopMouseover=!0}}))}chrome.runtime.onMessage.addListener((async function(e,t,r){"selectElements"===e.msg&&(chrome.runtime.sendMessage({msg:"Bring up active tab"}),stopAll=!1,freezeState=!1,1==runSelect&&(selectingElements(),runSelect=!1))}));var myField="",myLabel="";function PopupButtonClickDetector(e,t){let r=Object.keys(e);console.log(e);for(let c of r){if("disableSelect"===c&&"sync"===t&&(stopAll=!0),"removeElement"===c&&"sync"===t){removeBordered(JSON.parse(e.removeElement.newValue).field)}if("highlightElements"===c&&"sync"===t){console.log("highlighting elements");let t=JSON.parse(e.highlightElements.newValue);console.log("parsed"),console.log(t),t.highlightElements.forEach((e=>{mySelector=e.selectable.selector,myField=e.selectable.value,myLabel=e.selectable.label;let t=document.querySelector(mySelector);t&&t.classList.add("previousBorderPrimary",myField)})),chrome.runtime.sendMessage({msg:"Bring back scrape builder"})}if("selectElements"===c&&"sync"===t){console.log("bout to parse");let t=JSON.parse(e.selectElements.newValue);console.log("parsed"),myField=t.field,myLabel=t.label,console.log("bout to send bring up tab"),chrome.runtime.sendMessage({msg:"Bring up active tab"}),stopAll=!1,freezeState=!1,1==runSelect&&(console.log("running select"),selectingElements(),runSelect=!1)}"clearSelected"==c&&"sync"==t&&(activeSelected.length=0,prevSelected.length=0,filtManualSelected.length=0,borderedInnerHTML.length=0,prevNode=null,stopMouseover=!0,stopAll=!0,removeBorderAll())}}chrome.storage.onChanged.addListener(PopupButtonClickDetector),canvasProcess()}